#include <ultra64.h>
#include "sm64.h"
#include "behavior_data.h"
#include "model_ids.h"
#include "seq_ids.h"
#include "dialog_ids.h"
#include "segment_symbols.h"
#include "level_commands.h"

#include "game/level_update.h"

#include "levels/scripts.h"

#include "actors/common1.h"

/* Fast64 begin persistent block [includes] */
/* Fast64 end persistent block [includes] */

#include "make_const_nonconst.h"
#include "levels/jrb/header.h"

/* Fast64 begin persistent block [scripts] */
/* Fast64 end persistent block [scripts] */

const LevelScript level_jrb_entry[] = {
	INIT_LEVEL(),
	LOAD_MIO0(0x07, _jrb_segment_7SegmentRomStart, _jrb_segment_7SegmentRomEnd), 
	LOAD_MIO0(0x0B, _effect_mio0SegmentRomStart, _effect_mio0SegmentRomEnd), 
	LOAD_MIO0_TEXTURE(0x09, _water_mio0SegmentRomStart, _water_mio0SegmentRomEnd), 
	LOAD_MIO0(0x0A, _water_skybox_mio0SegmentRomStart, _water_skybox_mio0SegmentRomEnd), 
	LOAD_MIO0(0x06, _group14_mio0SegmentRomStart, _group14_mio0SegmentRomEnd), 
	LOAD_RAW(0x0D, _group14_geoSegmentRomStart, _group14_geoSegmentRomEnd), 
	LOAD_MIO0(0x08, _common0_mio0SegmentRomStart, _common0_mio0SegmentRomEnd), 
	LOAD_RAW(0x0F, _common0_geoSegmentRomStart, _common0_geoSegmentRomEnd), 
	ALLOC_LEVEL_POOL(),
	MARIO(MODEL_MARIO, 0x00000001, bhvMario), 
	JUMP_LINK(script_func_global_1), 
	JUMP_LINK(script_func_global_15), 
	LOAD_MODEL_FROM_GEO(0x35, watergate_geo), 
	LOAD_MODEL_FROM_GEO(0x36, stalkbig_geo), 
	LOAD_MODEL_FROM_GEO(0x37, stalkmiddle_geo), 
	LOAD_MODEL_FROM_GEO(0x38, stalksmall_geo), 
	LOAD_MODEL_FROM_GEO(0x39, huffnpuff_geo), 
	LOAD_MODEL_FROM_GEO(0x3A, huffnpuffbaby_geo), 
	LOAD_MODEL_FROM_GEO(0x3B, hammer_geo), 
	LOAD_MODEL_FROM_GEO(MODEL_THI_BUBBLY_TREE, bubbly_tree_geo), 

	/* Fast64 begin persistent block [level commands] */
	/* Fast64 end persistent block [level commands] */

	AREA(1, jrb_area_1),
		WARP_NODE(0x0A, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0x0b, LEVEL_JRB, 0x02, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0x0c, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0x0D, LEVEL_JRB, 0x03, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0x0E, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0x0F, LEVEL_JRB, 0x03, 0x0C, WARP_NO_CHECKPOINT),
		WARP_NODE(0x10, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0x11, LEVEL_JRB, 0x03, 0x0E, WARP_NO_CHECKPOINT),
		WARP_NODE(0x12, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0xF0, LEVEL_CASTLE_GROUNDS, 0x01, 0xE3, WARP_NO_CHECKPOINT),
		WARP_NODE(0xF1, LEVEL_BOB, 0x01, 0xD3, WARP_NO_CHECKPOINT),
		WARP_NODE(0x13, LEVEL_JRB, 0x04, 0x0A, WARP_CHECKPOINT),
		WARP_NODE(0x14, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		OBJECT(MODEL_NONE, 0, 0, 0, 0, 0, 0, 0x00020000, bhvBGMPlayer),
		OBJECT(MODEL_NONE, -618, 1068, 2814, 0, 0, 0, 0x00000000, bhvFloorSwitchHiddenObjects),
		OBJECT(MODEL_BREAKABLE_BOX, 27, 1068, 2546, 0, 0, 0, 0x00000000, bhvHiddenObject),
		OBJECT(MODEL_BREAKABLE_BOX, 27, 1268, 2486, 0, 0, 0, 0x00000000, bhvHiddenObject),
		OBJECT_WITH_ACTS(MODEL_PIRANHA_PLANT, 572, 2437, 777, 0, 0, 0, 0x00010000, bhvFirePiranhaPlant, ACT_1),
		OBJECT_WITH_ACTS(MODEL_PIRANHA_PLANT, -1980, 2312, 1623, 0, 0, 0, 0x00010000, bhvFirePiranhaPlant, ACT_1),
		OBJECT_WITH_ACTS(MODEL_PIRANHA_PLANT, -640, 2444, -115, 0, 0, 0, 0x00010000, bhvFirePiranhaPlant, ACT_1),
		OBJECT_WITH_ACTS(MODEL_PIRANHA_PLANT, 1385, 2514, 1986, 0, 0, 0, 0x00010000, bhvFirePiranhaPlant, ACT_1),
		OBJECT_WITH_ACTS(MODEL_PIRANHA_PLANT, -2661, 2312, -1389, 0, 0, 0, 0x00010000, bhvFirePiranhaPlant, ACT_1),
		OBJECT(MODEL_STAR, -2905, -1301, -1640, 0, 0, 0, 0x05000000, bhvStar),
		OBJECT(MODEL_STAR, 3505, 23, 1648, 0, 0, 0, 0x02000000, bhvStar),
		OBJECT(MODEL_BREAKABLE_BOX, 27, 1468, 2358, 0, 0, 0, 0x00000000, bhvHiddenObject),
		OBJECT(MODEL_BREAKABLE_BOX, 27, 1668, 2294, 0, 0, 0, 0x00000000, bhvHiddenObject),
		OBJECT(MODEL_BREAKABLE_BOX, 27, 1828, 2230, 0, 0, 0, 0x00000000, bhvHiddenObject),
		OBJECT(MODEL_BREAKABLE_BOX, 27, 2028, 2166, 0, 0, 0, 0x00000000, bhvHiddenObject),
		OBJECT(MODEL_NONE, 3983, -1682, -2098, 0, 0, 0, 0x000a0000, bhvAirborneWarp),
		OBJECT(MODEL_NONE, 2185, -1064, -604, 0, 90, 0, 0x000E0000, bhvAirborneWarp),
		OBJECT(MODEL_NONE, 1945, 220, 1298, 0, 90, 0, 0x00100000, bhvAirborneWarp),
		OBJECT(MODEL_NONE, -2258, 1084, 2441, 0, 0, 0, 0x00120000, bhvAirborneWarp),
		OBJECT(MODEL_NONE, -647, 5596, -399, 0, -180, 0, 0xFF130000, bhvWarp),
		OBJECT_WITH_ACTS(MODEL_BOBOMB_BUDDY, 2292, -1064, -1266, 0, 114, 0, (143 << 16), bhvBobombBuddy, ACT_1),
		OBJECT_WITH_ACTS(MODEL_BOBOMB_BUDDY, 2618, -1319, -3074, 0, 55, 0, (144 << 16), bhvBobombBuddy, ACT_2),
		OBJECT_WITH_ACTS(MODEL_BOBOMB_BUDDY, 2715, -1064, -852, 0, 150, 0, (145 << 16), bhvBobombBuddy, ACT_3 | ACT_4 | ACT_5 | ACT_6),
		OBJECT(MODEL_NONE, 2121, -684, -11, 0, 0, 0, (0x8C << 16), bhvPoleGrabbing),
		OBJECT(MODEL_NONE, 1670, -1615, -2890, 0, 0, 0, 0x007e0000, bhvPoleGrabbing),
		OBJECT(MODEL_NONE, -527, -774, -2892, 0, 0, 0, 0x007e0000, bhvPoleGrabbing),
		OBJECT(MODEL_NONE, -1989, -1112, -2909, 0, 0, 0, 0x007e0000, bhvPoleGrabbing),
		OBJECT(MODEL_NONE, -2711, -457, -2904, 0, 0, 0, 0x007e0000, bhvPoleGrabbing),
		OBJECT(MODEL_NONE, -3125, 140, -2896, 0, 0, 0, (91 << 16), bhvPoleGrabbing),
		OBJECT(MODEL_NONE, 316, -2238, 4193, 0, 0, 0, 0x00740000, bhvPoleGrabbing),
		OBJECT(MODEL_NONE, 441, -1481, 276, 0, 0, 0, 0x007e0000, bhvPoleGrabbing),
		OBJECT(MODEL_NONE, 441, -1481, 2356, 0, 0, 0, 0x007e0000, bhvPoleGrabbing),
		OBJECT(MODEL_NONE, 3869, -2607, 1269, 0, 0, 0, 0x00cb0000, bhvPoleGrabbing),
		OBJECT(0x17, 385, -2479, -1531, 0, 0, 0, 0x00020000, bhvTree),
		OBJECT(0x17, 535, -2479, -643, 0, 0, 0, 0x00020001, bhvTree),
		OBJECT(0x17, 1117, -2479, 778, 0, 0, 0, 0x00020002, bhvTree),
		OBJECT(0x17, 379, -2463, 1990, 0, 0, 0, 0x00020003, bhvTree),
		OBJECT(0, -6346, -3150, 8462, 0, 0, 0, 0x00000000, bhvLargeFishGroup),
		OBJECT(MODEL_RED_COIN, -11029, -2279, 260, 0, 0, 0, 0x00010000, bhvRedCoin),
		OBJECT(MODEL_RED_COIN, -4793, -2166, -11445, 0, 0, 0, 0x00010000, bhvRedCoin),
		OBJECT(MODEL_RED_COIN, 1116, -2545, -4875, 0, 0, 0, 0x00010000, bhvRedCoin),
		OBJECT(MODEL_RED_COIN, 5183, -2542, 1537, 0, 0, 0, 0x00010000, bhvRedCoin),
		OBJECT(MODEL_RED_COIN, 2403, -2548, 7144, 0, 0, 0, 0x00010000, bhvRedCoin),
		OBJECT(MODEL_RED_COIN, -2720, -2548, 8819, 0, 0, 0, 0x00010000, bhvRedCoin),
		OBJECT(MODEL_RED_COIN, -2583, -2242, 5760, 0, 0, 0, 0x00010000, bhvRedCoin),
		OBJECT(0, 5660, -1983, -2358, 0, 0, 0, 0x04000000, bhvHiddenRedCoinStar),
		OBJECT(0, 4498, -2550, 6789, 0, 0, 0, 0x00010000, bhvLargeFishGroup),
		OBJECT(0, 8842, -3150, -919, 0, 0, 0, 0x00000000, bhvLargeFishGroup),
		OBJECT(0, 1210, -3150, -6052, 0, 0, 0, 0x00010000, bhvLargeFishGroup),
		OBJECT(0, -6884, -3150, -2463, 0, 0, 0, 0x00000000, bhvLargeFishGroup),
		OBJECT(0, -4766, -3150, 1147, 0, 0, 0, 0x00000000, bhvLargeFishGroup),
		OBJECT(0, -6556, -3150, 9687, 0, 0, 0, 0x00000000, bhvLargeFishGroup),
		OBJECT(0, -710, -2906, 6257, 0, 0, 0, 0x00040000, bhvLargeFishGroup),
		OBJECT(0, 5761, -3150, -6400, 0, 0, 0, 0x00040000, bhvLargeFishGroup),
		OBJECT(0, -5559, -3150, -2541, 0, 0, 0, 0x00040000, bhvLargeFishGroup),
		OBJECT(MODEL_RED_COIN, -6225, -2195, 5931, 0, 0, 0, 0x00010000, bhvRedCoin),
		OBJECT_WITH_ACTS(0x37, 0, 0, 0, 0, 0, 0, 0x00010000, bhvMiddleStalk, ACT_2),
		OBJECT_WITH_ACTS(0x36, -640, 2444, -376, 0, 0, 0, 0x00010000, bhvBigStalk, ACT_3 | ACT_4 | ACT_5 | ACT_6),
		OBJECT_WITH_ACTS(0x38, -640, 2444, -671, 0, 0, 0, 0x00010000, bhvSmallStalk, ACT_1),
		OBJECT(0xF2, 48, -2479, -1554, 0, 0, 0, 0x00020000, bhvRoamingPokemon),
		OBJECT(0, 74, 1068, 3142, 0, 0, 0, (0x02 << 16), bhvCoinFormation),
		OBJECT(0, -1462, 1068, 3156, 0, 0, 0, (0x02 << 16), bhvCoinFormation),
		OBJECT(0, 3406, 2273, 2582, 0, 0, 0, (0 << 16), bhvCoinFormation),
		OBJECT(0, -1886, 2669, 559, 0, 0, 0, (0 << 16), bhvCoinFormation),
		OBJECT(0, 7133, -2413, 2630, 0, 0, 0, (0 << 16), bhvCoinFormation),
		OBJECT(0, 6442, -2413, 4203, 0, 90, 0, (0 << 16), bhvCoinFormation),
		OBJECT(0, 1939, -2413, 5591, 0, 0, 0, (0 << 16), bhvCoinFormation),
		OBJECT(0, 6186, -2413, 855, 0, -90, 0, (4 << 16), bhvCoinFormation),
		OBJECT(0, -6241, -2413, 830, 0, 0, 0, (0 << 16), bhvCoinFormation),
		OBJECT(0, -5414, -2413, -8369, 0, 0, 0, (0 << 16), bhvCoinFormation),
		OBJECT(0, -3232, -2358, -6002, 0, 90, 0, (0 << 16), bhvCoinFormation),
		OBJECT(0, 2932, -2414, -7166, 0, 61, 0, (0 << 16), bhvCoinFormation),
		OBJECT(0, 4620, -1934, 4799, 0, 61, 0, (0x11 << 16), bhvCoinFormation),
		OBJECT(0, 2635, -1496, 4728, 0, 61, 0, (0x11 << 16), bhvCoinFormation),
		OBJECT(0, -1896, -978, 4630, 0, 61, 0, (0x11 << 16), bhvCoinFormation),
		OBJECT(0, 2658, -469, 3916, 0, 61, 0, (0x11 << 16), bhvCoinFormation),
		OBJECT(0, 2121, -684, -11, 0, 61, 0, (0x11 << 16), bhvCoinFormation),
		OBJECT(0, 1758, 3488, -1015, 0, 0, 0, (0 << 16), bhvCoinFormation),
		OBJECT(MODEL_NONE, -3043, 140, -2388, 0, 0, 0, 0x100b0000, bhvWarp),
		OBJECT(MODEL_NONE, -3043, 140, -2694, 0, -180, 0, 0x000c0000, bhvAirborneWarp),
		OBJECT(MODEL_NONE, -2843, 140, -2388, 0, 0, 0, 0x100b0000, bhvWarp),
		OBJECT(MODEL_NONE, -3244, 140, -2388, 0, 0, 0, 0x100b0000, bhvWarp),
		OBJECT(MODEL_NONE, 1488, -1064, -601, 0, 0, 0, 0x100D0000, bhvWarp),
		OBJECT(MODEL_NONE, 1488, -1064, -291, 0, 0, 0, 0x100D0000, bhvWarp),
		OBJECT(MODEL_NONE, 1488, -1064, -911, 0, 0, 0, 0x100D0000, bhvWarp),
		OBJECT(MODEL_NONE, 1047, 10, 1297, 0, 0, 0, 0x100F0000, bhvWarp),
		OBJECT(MODEL_NONE, 1047, 10, 1607, 0, 0, 0, 0x100F0000, bhvWarp),
		OBJECT(MODEL_NONE, 1047, 10, 987, 0, 0, 0, 0x100F0000, bhvWarp),
		OBJECT(MODEL_NONE, -2142, 1172, 1884, 0, 90, 0, 0x10110000, bhvWarp),
		OBJECT(MODEL_NONE, -1832, 1172, 1884, 0, 90, 0, 0x10110000, bhvWarp),
		OBJECT(MODEL_NONE, -2452, 1172, 1884, 0, 90, 0, 0x10110000, bhvWarp),
		TERRAIN(jrb_area_1_collision),
		MACRO_OBJECTS(jrb_area_1_macro_objs),
		SET_BACKGROUND_MUSIC(0x00, SEQ_LEVEL_ATLANTIS),
		TERRAIN_TYPE(TERRAIN_GRASS),
		/* Fast64 begin persistent block [area commands] */
		/* Fast64 end persistent block [area commands] */
	END_AREA(),

	AREA(2, jrb_area_2),
		WARP_NODE(0x0A, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0x0B, LEVEL_JRB, 0x01, 0x0C, WARP_NO_CHECKPOINT),
		WARP_NODE(0xf0, LEVEL_CASTLE_GROUNDS, 0x01, 0xe3, WARP_NO_CHECKPOINT),
		WARP_NODE(0xf1, LEVEL_CASTLE_GROUNDS, 0x01, 0xd3, WARP_NO_CHECKPOINT),
		OBJECT(MODEL_NONE, -3002, -1799, -5546, 0, 0, 0, 0x000a0000, bhvAirborneWarp),
		OBJECT(MODEL_NONE, -2707, -1863, -6581, 0, 0, 0, 0x400B0000, bhvWarp),
		OBJECT(MODEL_STAR, 2751, -1202, 428, 0, 0, 0, 0x01000000, bhvStar),
		OBJECT(MODEL_PURPLE_SWITCH, -2707, -1775, 5875, 0, 0, 0, 0x000a0000, bhvFloorSwitchAnimatesObject),
		OBJECT(0x35, -2267, -1863, 2365, 0, 0, 0, 0x000a0000, bhvWatergate),
		OBJECT(0, -2408, -1799, -435, 0, 0, 0, (0x11 << 16), bhvCoinFormation),
		OBJECT(0, -3004, -1772, 2485, 0, 0, 0, (0x11 << 16), bhvCoinFormation),
		OBJECT(MODEL_NONE, -2707, -1826, 5246, 0, 0, 0, 0x000a0000, bhvWaterForce),
		TERRAIN(jrb_area_2_collision),
		MACRO_OBJECTS(jrb_area_2_macro_objs),
		SET_BACKGROUND_MUSIC(0x00, SEQ_LEVEL_ATLANTIS),
		TERRAIN_TYPE(TERRAIN_GRASS),
		/* Fast64 begin persistent block [area commands] */
		/* Fast64 end persistent block [area commands] */
	END_AREA(),

	AREA(3, jrb_area_3),
		WARP_NODE(0x0A, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0x0B, LEVEL_JRB, 0x01, 0x0E, WARP_NO_CHECKPOINT),
		WARP_NODE(0x0C, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0x0D, LEVEL_JRB, 0x01, 0x10, WARP_NO_CHECKPOINT),
		WARP_NODE(0x0E, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0x0F, LEVEL_JRB, 0x01, 0x12, WARP_NO_CHECKPOINT),
		WARP_NODE(0x0A, LEVEL_CASTLE_GROUNDS, 0x01, 0xe3, WARP_NO_CHECKPOINT),
		WARP_NODE(0x0A, LEVEL_CASTLE_GROUNDS, 0x01, 0xd3, WARP_NO_CHECKPOINT),
		OBJECT(MODEL_NONE, 1873, -1960, -1489, 0, -90, 0, 0x000a0000, bhvAirborneWarp),
		OBJECT(MODEL_NONE, 1804, -312, 1416, 0, -90, 0, 0x000C0000, bhvAirborneWarp),
		OBJECT(MODEL_NONE, -1575, -51, 1762, 0, 180, 0, 0x000E0000, bhvAirborneWarp),
		OBJECT(MODEL_NONE, -377, -775, 1061, 0, 0, 0, 0x00BC0000, bhvPoleGrabbing),
		OBJECT(MODEL_NONE, 1010, -775, 1061, 0, 0, 0, 0x00BC0000, bhvPoleGrabbing),
		OBJECT(MODEL_NONE, -937, -1159, -1639, 0, 0, 0, 0x00eC0000, bhvPoleGrabbing),
		OBJECT(0, -462, -1913, -1534, 0, 0, 0, (0x11 << 16), bhvCoinFormation),
		OBJECT(0, -964, -1293, -451, 0, 0, 0, (0 << 16), bhvCoinFormation),
		OBJECT(0, 160, -348, 1741, 0, 90, 0, (0 << 16), bhvCoinFormation),
		OBJECT(0, -1747, -910, -823, 0, 0, 0, (0 << 16), bhvCoinFormation),
		OBJECT(MODEL_NONE, 2361, -1960, -1725, 0, 0, 0, 0x100B0000, bhvWarp),
		OBJECT(MODEL_NONE, 2361, -1960, -1291, 0, 0, 0, 0x100B0000, bhvWarp),
		OBJECT(MODEL_NONE, 2351, -1960, -1493, 0, 0, 0, 0x100B0000, bhvWarp),
		OBJECT(MODEL_NONE, 2361, -349, 1197, 0, 0, 0, 0x100D0000, bhvWarp),
		OBJECT(MODEL_NONE, 2361, -349, 1631, 0, 0, 0, 0x100D0000, bhvWarp),
		OBJECT(MODEL_NONE, 2351, -349, 1428, 0, 0, 0, 0x100D0000, bhvWarp),
		OBJECT(MODEL_NONE, -1789, -51, 2367, 0, 90, 0, 0x100F0000, bhvWarp),
		OBJECT(MODEL_NONE, -1355, -51, 2367, 0, 90, 0, 0x100F0000, bhvWarp),
		OBJECT(MODEL_NONE, -1558, -51, 2377, 0, 90, 0, 0x100F0000, bhvWarp),
		TERRAIN(jrb_area_3_collision),
		MACRO_OBJECTS(jrb_area_3_macro_objs),
		SET_BACKGROUND_MUSIC(0x00, SEQ_LEVEL_ATLANTIS),
		TERRAIN_TYPE(TERRAIN_GRASS),
		/* Fast64 begin persistent block [area commands] */
		/* Fast64 end persistent block [area commands] */
	END_AREA(),

	AREA(4, jrb_area_4),
		WARP_NODE(0x0A, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0x0B, LEVEL_JRB, 0x01, 0x0C, WARP_NO_CHECKPOINT),
		WARP_NODE(0xf0, LEVEL_CASTLE_GROUNDS, 0x01, 0xe3, WARP_NO_CHECKPOINT),
		WARP_NODE(0xf1, LEVEL_CASTLE_GROUNDS, 0x01, 0xd3, WARP_NO_CHECKPOINT),
		OBJECT(0x39, 46, 371, -1005, 0, 0, 0, 0x03000000, bhvHuffPuff),
		OBJECT(MODEL_NONE, 46, -89, 1361, 0, -180, 0, 0x000a0000, bhvAirborneWarp),
		OBJECT(0x3B, 0, 0, 4, 0, -180, 0, 0x000a0000, bhvBetaHoldableObject),
		TERRAIN(jrb_area_4_collision),
		MACRO_OBJECTS(jrb_area_4_macro_objs),
		SET_BACKGROUND_MUSIC(0x00, 0),
		TERRAIN_TYPE(TERRAIN_GRASS),
		/* Fast64 begin persistent block [area commands] */
		/* Fast64 end persistent block [area commands] */
	END_AREA(),

	FREE_LEVEL_POOL(),
	MARIO_POS(1, 0, 0, 0, 0),
	CALL(0, lvl_init_or_update),
	CALL_LOOP(1, lvl_init_or_update),
	CLEAR_LEVEL(),
	SLEEP_BEFORE_EXIT(1),
	EXIT(),
};
